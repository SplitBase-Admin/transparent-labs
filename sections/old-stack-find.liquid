

<div class="xgen-stack-find">
  <div class="xgen-inner">
    
    <div class="stack-find-wraper">
      <div class="stack-find-top">
        {% if section.settings.heading %}
          <h2 class="heading">{{ section.settings.heading }}</h2>
        {% endif %}


        {% if section.settings.subheading %}
          <p class="subheading">{{ section.settings.subheading }}</p>
        {% endif %}

      </div>

      <div class="stack-find">
        
        <div class="accordion">
        <form id="email_signup" class="klaviyo_styling klaviyo_gdpr_embed_TQDt27" action="//manage.kmail-lists.com/subscriptions/subscribe" data-ajax-submit="//manage.kmail-lists.com/ajax/subscriptions/subscribe" method="GET" target="_blank">
          <input type="hidden" name="g" value="TQDt27  ">
          <input type="hidden" name="$fields" value="$consent">
          <input type="hidden" name="$list_fields" value="$consent">
          
          <div class="input-wraper">
            <label for="goals">Goals</label>
            <select id="goals" name="goals">
              <option value="Bulking">Bulking</option>
              <option value="Cutting">Cutting</option>
              <option value="Body Recomposition">Body Recomposition</option>
              <option value="General Health and Wellness">General Health and Wellness</option>
            </select>
          </div>

          <div class="input-wraper">
            <label for="dietary">Dietary Restricions</label>
            <select id="dietary" name="dietary">
              <option value="None">None</option>
              <option value="Vegan">Vegan</option>
              <option value="Stimulant Free">Stimulant Free</option>
            </select>
          </div>
          <div class="input-wraper">
            <label for="height">Height</label>
            <div class="input-wraper2">
              <input class="form_ft" type="text" name="height" placeholder="ft"  required=""/>
            </div>
          </div>

          <div class="input-wraper">
            <label for="weight_num">Weight</label>
            <div class="input-wraper1">
              <input class="weight_num" type="text" name="weight_num" placeholder="73"  required=""/>
              <select id="weight" name="weight" class="min-select">
                <option value="kg">kg</option>
                <option value="lbs">lbs</option>
              </select>
            </div>
          </div>

          <div class="input-wraper">
            <label class="gender">Gender</label>
            <select id="gender" name="gender">
              <option class="Male">Male</option>
              <option class="Female">Female</option>
              <option class="Nonbinary">Nonbinary</option>
              <option class="Rather Not Say">Rather Not Say</option>
            </select>
          </div>
          
          <div class="input-wraper">
            <label>Email</label>
            <input id="email" name="email" type="text" placeholder="Your Email" required=""/>
          </div>

          <button type="submit" class="btn klaviyo_submit_button submit_form_btn">Find My Stacks</button>

        </form>
        </div>
        
        <div class="klaviyo_messages">
          <div class="success_message" style="display:none;"></div>
          <div class="error_message" style="display:none;"></div>
        </div>
        
      </div>
    </div>
  
  </div>
</div>

<style type="text/css">
  .klaviyo_styling.klaviyo_gdpr_embed_LIST_ID,
  .klaviyo_condensed_styling.klaviyo_gdpr_embed_LIST_ID {
    font-family: "Helvetica Neue", Arial;
  }

  .klaviyo_styling.klaviyo_gdpr_embed_LIST_ID .klaviyo_helptext,
  .klaviyo_condensed_styling.klaviyo_gdpr_embed_LIST_ID .klaviyo_helptext {
    font-family: "Helvetica Neue", Arial;
    padding-top: 10px;
    padding-bottom: 10px;
  }

  .klaviyo_styling.klaviyo_gdpr_embed_LIST_ID .klaviyo_gdpr_text,
  .klaviyo_condensed_styling.klaviyo_gdpr_embed_LIST_ID .klaviyo_gdpr_text {
    font-size: 14px;
    line-height: 1.3;
  }

  .klaviyo_styling.klaviyo_gdpr_embed_LIST_ID label,
  .klaviyo_condensed_styling.klaviyo_gdpr_embed_LIST_ID label {
    color: #222;
  }

  .klaviyo_styling .klaviyo_field_group .klaviyo_form_actions {
    text-align: left;
  }

  .klaviyo_styling.klaviyo_gdpr_embed_LIST_ID input[type=checkbox]+label,
  .klaviyo_condensed_styling.klaviyo_gdpr_embed_LIST_ID input[type=checkbox]+label {
    display: inline;
    font-weight: normal;
    padding-left: 5px;
  }

  .klaviyo_styling.klaviyo_gdpr_embed_LIST_ID input[type=text],
  .klaviyo_styling.klaviyo_gdpr_embed_LIST_ID input[type=email],
  .klaviyo_condensed_styling.klaviyo_gdpr_embed_LIST_ID input[type=text],
  .klaviyo_condensed_styling.klaviyo_gdpr_embed_LIST_ID input[type=email] {
    border-radius: 2px;
  }

  .klaviyo_styling.klaviyo_gdpr_embed_LIST_ID .klaviyo_submit_button,
  .klaviyo_condensed_styling.klaviyo_gdpr_embed_LIST_ID .klaviyo_submit_button {
    background-color: #0064cd;
    border-radius: 2px;
  }

  .klaviyo_styling.klaviyo_gdpr_embed_LIST_ID .klaviyo_submit_button:hover,
  .klaviyo_condensed_styling.klaviyo_gdpr_embed_LIST_ID .klaviyo_submit_button:hover {
    background-color: #0064cd;
  }
</style>
<script type="text/javascript" src="https://www.klaviyo.com/media/js/public/klaviyo_subscribe.js" defer></script>
<script type="text/javascript">
  document.addEventListener('DOMContentLoaded', function() {
    KlaviyoSubscribe.attachToForms('#email_signup', {
    success: function ($form) {
      //console.log($form);
      after_submit();
 // `$form` is a jQuery wrapper around the form that was submitted. This makes it easy to get the email address or form fields.
   var email = document.querySelector('[name="email"]').value;
   _learnq.push(['identify', { $email: email }]);
   _learnq.push(['track', 'Signed Up for Newsletter']);
 },
    hide_form_on_success: true,
    extra_properties: {
      $source: '$embed',
      $method_type: "Klaviyo Form",
      $method_id: 'embed',
      $consent_version: 'Embed default text'
    }
  });
  
  function after_submit(){
    const goals = document.getElementById("goals").value;
    const dietary = document.getElementById("dietary").value;
    const form_ft = document.querySelector(".form_ft").value;
    const weight = document.getElementById("weight").value;
    const gender = document.getElementById("gender").value;
    const email = document.getElementById("email").value;
    
    const regex = /^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/; 
    const email_ex = regex.test(email);
    
    if(email_ex){
      document.getElementById("email").classList.remove("error_email");
      
      // Remove active class from all tabs
      document.querySelectorAll("#tablinks").forEach(function(tab) {
        tab.classList.remove("active");
      });
      
      if(dietary === 'None' && goals === 'Bulking' ){
        const tab2 = document.getElementById("protab_2");
        if (tab2) {
          tab2.classList.add("active");
          // Smooth scroll to element
          const target = document.getElementById('xgen-new-collection');
          if (target) {
            target.scrollIntoView({ behavior: 'smooth' });
          }
          tab2.click();
        }
      } else if( dietary === 'None' && goals === 'Cutting' ){
        const tab3 = document.getElementById("protab_3");
        if (tab3) {
          tab3.classList.add("active");
          const target = document.getElementById('xgen-new-collection');
          if (target) {
            target.scrollIntoView({ behavior: 'smooth' });
          }
          tab3.click();
        }
      } else if( dietary === 'None' && goals === 'Body Recomposition' ){
        const tab4 = document.getElementById("protab_4");
        if (tab4) {
          tab4.classList.add("active");
          const target = document.getElementById('xgen-new-collection');
          if (target) {
            target.scrollIntoView({ behavior: 'smooth' });
          }
          tab4.click();
        }
      } else if( dietary === 'None' && goals === 'General Health and Wellness' ){
        const tab7 = document.getElementById("protab_7");
        if (tab7) {
          tab7.classList.add("active");
          const target = document.getElementById('xgen-new-collection');
          if (target) {
            target.scrollIntoView({ behavior: 'smooth' });
          }
          tab7.click();
        }
      }
      
      if(dietary === 'Vegan' && (goals === 'Bulking' || goals === 'Cutting' || goals === 'Body Recomposition' || goals === 'General Health and Wellness')){
        const tab5Products = document.querySelectorAll("#tab_5 .xgen-new-product");
        tab5Products.forEach(product => product.style.display = "none");
        
        const veganProducts = document.querySelectorAll(".vegan_class");
        veganProducts.forEach(product => product.style.display = "block");
        
        const tab5 = document.getElementById("protab_5");
        if (tab5) {
          tab5.classList.add("active");
          const target = document.getElementById('xgen-new-collection');
          if (target) {
            target.scrollIntoView({ behavior: 'smooth' });
          }
          tab5.click();
        }
      }
      
      if(dietary === 'Stimulant Free' && (goals === 'Bulking' || goals === 'Cutting' || goals === 'Body Recomposition' || goals === 'General Health and Wellness')){
        const tab6Products = document.querySelectorAll("#tab_6 .xgen-new-product");
        tab6Products.forEach(product => product.style.display = "none");
        
        const stimulantFreeProducts = document.querySelectorAll(".StimulantFree");
        stimulantFreeProducts.forEach(product => product.style.display = "block");
        
        const tab6 = document.getElementById("protab_6");
        if (tab6) {
          tab6.classList.add("active");
          const target = document.getElementById('xgen-new-collection');
          if (target) {
            target.scrollIntoView({ behavior: 'smooth' });
          }
          tab6.click();
        }
      }

    } else {
      document.getElementById("email").classList.add("error_email");
    }
  };
  })
</script>


{% comment %}
<script>
  $(document).ready(function(){
    
  });
</script>
{% endcomment %}

{% schema %}
  {
    "name": "Stack Find",
    "class": "td-legacy",
    "settings": [
		{
        	"type":"text",
        	"id":"heading",
        	"label":"Heading"
        },
        {
        	"type":"textarea",
        	"id":"subheading",
        	"label":"Sub Heading"
        },
		{
        	"type":"text",
        	"id":"btn_text",
        	"label":"Button Text"
        },
        {
        	"type":"url",
        	"id":"btn_url",
        	"label":"Button URL"
        }
	],
	"blocks":[
		{
			"name":"Block",
			"type":"text",
			"settings":[
				
				{
                    "type":"text",
                    "id":"text1",
                    "label":"Small Text"
                },
                {
                    "type":"text",
                    "id":"text2",
                    "label":"Large Text"
                },
                {
                    "type":"textarea",
                    "id":"text3",
                    "label":"Text"
                }

			]
		}
	],
	"presets":[
		{
			"name": "Stack Find"
		}
	]
  }
{% endschema %}

{% stylesheet %}
{% endstylesheet %}

{% javascript %}
{% endjavascript %}
 