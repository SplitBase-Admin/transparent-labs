{% layout none %}

<div class="!bg-white !p-4 !rounded flex flex-col h-full justify-between">
  <div class="!mb-2">
    <a href="{{ product.url }}">
      <img class="mb-4 mx-auto" loading="lazy" src="{{ product.featured_image | image_url: height: 200 }}" height="200" width="200" />
    </a>

    <div class="flex items-center justify-between">
      <div class="flex mb-2 space-x-1 sm:mb-0">
        {%- assign review_average = product.metafields.yotpo.reviews_average | times: 1 -%}
        {%- for i in (1..5) -%}
          {%- assign index_minus_one = i | minus: 1 -%}
          {%- assign mod = review_average | modulo: index_minus_one -%}

          {%- if review_average >= i -%}
            <svg class="h-4 w-4" version="1.1" viewBox="0 0 128 128" xmlns="http://www.w3.org/2000/svg">
              <path d="m47.961 48h-47.945l39.914 31.543-15.941 48.441 40.059-29.871 39.938 29.871-15.871-48.863 39.918-31.121h-47.945l-16.094-47.996z" fill="#41B5E8"/>
            </svg>
          {%- elsif mod >= 0.5 -%}
            <svg class="h-4 w-4" version="1.1" viewBox="0 0 128 128" xmlns="http://www.w3.org/2000/svg">
              <path d="m128.02 48h-47.953l-16.094-48-16.031 48h-47.969l39.937 31.555-15.953 48.445 39.984-29.812 0.09375-0.0625 39.938 29.875-15.875-48.867zm-39.594 58.531-24.371-18.547-0.058594 0.0625v-56.953l10.164 24.906h29.812l-25.453 19.43z" fill="#41B5E8"/>
              </svg>
          {%- else -%}
            <svg class="h-4 w-4" version="1.1" viewBox="0 0 128 128" xmlns="http://www.w3.org/2000/svg">
              <path d="m64.008 31.113 10.172 24.887h29.809l-25.449 19.426 9.9023 31.105-24.387-18.543-24.387 18.109 9.8711-30.156-25.539-19.941h29.871l10.137-24.887m-16.043 16.887h-47.949l39.914 31.551-15.93 48.445 40.055-29.867 39.934 29.871-15.875-48.871 39.918-31.129h-47.945l-16.094-47.996z" fill="#41B5E8"/>
            </svg>
          {%- endif %}
        {%- endfor -%}
      </div>

      <div class="font-bold">{{ product.price_max | money }}</div>
    </div>
    <p class="font-bold !my-2">{{ product.title | escape }}</p>
  </div>

  <div class="space-y-2">
    {% unless product.tags contains 'stack' %}
      <form method="post" action="/cart/add">
        <input type="hidden" name="id" value="{{ product.variants.first.id }}" />
        <input type="submit" value="Add to Cart" class="!bg-blue-400 !py-3 !rounded !text-center !text-sm !text-white cursor-pointer w-full" />
      </form>
    {% endunless %}

    <a
      class="!border-2 !border-blue-400 !border-solid !rounded !text-blue-400 !text-center block py-3 text-sm"
      href="{{ product.url }}"
    >
      View Details
    </a>
  </div>
</div>
