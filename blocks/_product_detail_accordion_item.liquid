{%  stylesheet %}
.sb-product-detail__accordion-item .sb-accordion__item {
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.sb-product-detail__accordion-item .sb-accordion__trigger {
  display: flex;
  justify-content: space-between;
  align-items: center;
  width: 100%;
  padding: 16px 0;
  background: none;
  border: none;
  text-align: left;
  font-weight: 400;
  font-size: 16px;
  cursor: pointer;
  color: inherit;
  font-family: var(--sb-font-family-body);
}
.sb-product-detail__accordion-item-divider {
  display: block;
  width: 100%;
  height: 1px;
  background-color: var(--sb-fg-color-lightened, #000);
  opacity: 0.37;
}

.sb-product-detail__accordion-item .sb-accordion__icon {
  width: 24px;
  height: 24px;
  position: relative;
  transition: transform 0.3s ease;
}


.sb-product-detail__accordion-item.sb-accordion__item--expanded .sb-accordion__icon {
  transform: rotate(45deg);
}

.sb-product-detail__accordion-item .sb-accordion__content {
  max-height: 0;
  overflow: hidden;
  transition: all 0.4s cubic-bezier(0.215, 0.61, 0.355, 1);
  padding: 0;
  line-height: 1.3;
  font-size: 14px;
  opacity: 0;
  transform: translateY(-10px);
}

.sb-product-detail__accordion-item .sb-accordion__content a {
  color: var(--sb-fg-color, #111314);
  text-decoration: underline;
}

.sb-product-detail__accordion-item.sb-accordion__item--expanded .sb-accordion__content {
  max-height: 1000px; /* Large enough to contain content */
  padding: 0 0 16px;
  opacity: 1;
  transform: translateY(0);
  visibility: visible;
}

.sb-product-detail__accordion-item .sb-accordion-item__text-content,
.sb-product-detail__accordion-item .sb-accordion-item__image-content {
  width: 100%;
  padding-bottom: 16px;
}
.sb-product-detail__accordion-item.sb-accordion__item.sb-accordion__item--expanded .sb-accordion__trigger {
padding-bottom: 12px;
}

.sb-product-detail__accordion-item .sb-accordion-item__text-content p {
  margin: 0 0 10px 0;
  opacity: 0.64;
}

.sb-product-detail__accordion-item .sb-accordion-item__text-content p:last-child {
  margin-bottom: 0;
}

.sb-product-detail__accordion-item .sb-accordion-item__image-content img {
  width: 100%;
  height: auto;
  display: block;
}

.sb-accordion-item__text-content strong{
  font-weight: 500;
  color: rgba(17, 19, 20, 0.8) !important;
}

@media screen and (min-width: 1024px) {
  .sb-product-detail__accordion-item .sb-accordion__content {
    background-color: var(--sb-bg-color, #fff);
  }
  .sb-product-detail__accordion-item .sb-accordion__trigger {
    padding: 16px 0 24px;
  }
}
{% endstylesheet %}

{%  liquid
  assign has_heading = false
  if block.settings.heading != empty
    assign has_heading = true
  endif
  assign content = blank
  assign has_content = false
  if block.settings.content_type == 'text' and block.settings.content != empty
    assign has_content = true
    assign content = block.settings.content
  elsif block.settings.image != blank
    assign has_content = true
  elsif block.settings.content_type == 'metafield' and block.settings.metafield != empty
    assign split_metafield = block.settings.metafield | split: '.'
    assign namespace = split_metafield[0]
    if split_metafield.size > 1
      assign key = split_metafield[1]
    else
      assign key = split_metafield[0]
      assign namespace = 'custom'
    endif
    assign content = product.metafields[namespace][key].value
    if content != blank
      assign has_content = true
    endif
  endif
%}
{%  if has_heading and has_content %}
  <div class="sb-product-detail__accordion-item-divider">&nbsp;</div> 
  <div class="sb-product-detail__accordion-item sb-accordion__item" {% if block.settings.open_by_default %}data-default-open{% endif %}>
    <button class="sb-accordion__trigger" aria-expanded="false">
      {{ block.settings.heading }}
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="25" viewBox="0 0 24 25" fill="none" class="sb-accordion__icon">
      <path d="M12 3.55322V20.5532M20.5 12.0532H3.5" stroke="currentColor" stroke-linecap="round"/>
      </svg>
    </button>
    <div class="sb-accordion__content">
      {% if block.settings.content_type == 'image' %}
        <div class="sb-accordion-item__image-content">
          {% if template == "product" %}
            <div class="main-product-sfp" id="main-product-sfp">
            {{ product.metafields.product_details.sfp.value | image_url:width:800, height:800 | image_tag  }}
            </div>
            {% for variant in product.variants %}
              {% assign variant_meta = variant.metafields.product_details.sfp.value %}
              <div class="variant_meta_image" data-variant-sfp="{{ variant.id }}"  variant-title="{{ variant.title }}">
                <img src="{{ variant_meta | image_url:width:800, height:800 }}" width="auto" height="auto" loading="lazy" alt="{{ variant.title }}" variant-meta="{{ variant_meta | image_url:width:800, height:800 }}">
              </div>    
            {% endfor %} 
          {% else %}
            {{ block.settings.image | image_url: width: 600 | image_tag: loading: 'lazy', alt: block.settings.heading }}
          {% endif %}
        </div>
      {% else %}
        <div class="sb-accordion-item__text-content">
          {{ content }}
          
        </div>
      {% endif %}
    </div>
  </div>
{% endif %}

{% schema %}
{
  "name": "Accordion Item",
  "settings": [
    {
      "type": "checkbox",
      "id": "open_by_default",
      "label": "Open by default",
      "info": "Only the first item set to open by default will be visible when the page loads."
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Accordion Heading"
    },
    {
      "type": "select",
      "id": "content_type",
      "label": "Content Type",
      "options": [
        {
          "value": "text",
          "label": "Text"
        },
        {
          "value": "image",
          "label": "Image"
        },
        {
          "value": "metafield",
          "label": "Metafield"
        }
      ],
      "default": "text"
    },
    {
      "type": "richtext",
      "id": "content",
      "label": "Content",
      "visible_if": "{{ block.settings.content_type == 'text' }}",
      "default": "<p>Add your content here.</p>"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "Image",
      "visible_if": "{{ block.settings.content_type == 'image' }}"
    },
    {
      "type": "text",
      "id": "metafield",
      "label": "Metafield",
      "info": "The metafield namespace and key to display. The value will be displayed as a text block.",
      "visible_if": "{{ block.settings.content_type == 'metafield' }}"
    }
  ],
  "presets": [
    {
      "name": "Accordion Item"
    }
  ]
}
{% endschema %}
